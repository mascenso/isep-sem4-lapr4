@startuml

autoactivate on

actor User as U
participant "ShareABoardUI" as UI
participant "ShareABoardController" as C
participant "ListBoardsService" as S
participant "ShareBoard" as SB
participant "SharedBoardUser" as SBU
participant "AcessType" as AT
participant "BoardSharedEvent" as E
participant "Notification" as N
database "UsersRepository" as UR
database "ShareBoardRepository" as SBR
database "NotificationRepository" as NR


U -> UI:Share a board
UI -> C: getMyBoards(User)
C->S:getMyBoards(User)
S->SBR: getAll()
SBR-->S: listOfBoards
S-->C: myBoardsList
C-->UI: myBoardsList
UI-->U: Select Board

U->UI:Board
UI -> C: getAllUsers(), getAccessTypes()
C -> UR: getAllUsers()
UR --> C: listOfUsers

C->AT: getAccessTypes()
AT-->C: accessTypes
C --> UI: listOfUsers,accessTypes

UI -> UI: showAllUsers()

loop user select option 0(exit)
UI --> U: Select User
U -> UI: User
UI-->U: Select Access Type
U->UI: Access Type
end

UI->C:createShareBoardUsers(usersWithPermissions,BoardID)
C->SB: createShareBoardUsers(usersWithPermissions, BoardID)

loop number of selected Users
SB-> SBU: createShareBoardUsers(usersWithPermissions, BoardID)
SBU->E: createNotification(usersWithPermissions,BoardID);
E->N: createNotification(usersWithPermissions, timestamp,BoardID);
N-->E: notifications
E-->SBU: notifications
SBU-->SB: shareABoard, notifications
end

SB-->C:shareABoard,notifications
C->SBR: save(shareABoard)
C->NR: save(notifications)

@enduml
